# ASP.NET
# Build and test ASP.NET projects.
# Add steps that publish symbols, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/apps/aspnet/build-aspnet-4


pool:
  vmImage: 'windows-latest'

steps:

  - task: UseDotNet@2
    displayName: 'Use .NET Core 6 sdk'
    inputs:
      version: '6.0.x'

  - task: CmdLine@2
    env:
      SYSTEM_ACCESSTOKEN: $(System.AccessToken)
      DOTNET_USE_POLLING_FILE_WATCHER: 1
    inputs:
      script: './build.cmd'

  - task: PublishBuildArtifacts@1
    displayName: Publish packages artifact
    inputs:
      artifactName: 'packages'
      pathToPublish: '$(Build.SourcesDirectory)/output/packages'

  - task: NuGetCommand@2
    displayName: Push to Myget prereleases
    inputs:
      command: 'push'
      packagesToPush: '$(Build.SourcesDirectory)/output/packages/*.nupkg'
      nuGetFeedType: 'external'
      publishFeedCredentials: 'Myget Yuzu Prereleases'
